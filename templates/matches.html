{%load static%} {%load humanize %} {%load tags%}
<!DOCTYPE html>
<html lang="en">

<head>
    {% include "components/head.html" %}
</head>

<body>
    <header id="header">
        <div id="create" class="modal" style="overflow: visible;">
            <form method="post" onsubmit="createMatch(this)">
                <div class="modal-content" style="width:100%;">
                    <center>
                        <h4>Match</h4>
                    </center>
                    <input type="hidden" name="user" value="{{user}}">
                    <input type="hidden" name="status" value="Upcoming">
                    <input type="text" name="Venue" placeholder="Venue" required>
                    <input type="text" name="Type" value="" placeholder="Type" required>
                    <input type="hidden" name="id" value="{{tour.id}}" required>
                    <div class="row center">
                        <div class="col l5 center">
                            <select name="Winner">
                                {%for i in tour.teams|split:1 %}
                                <option value="{{i}}">{{i}}</option>
                                {%endfor%}
                            </select>
                        </div>
                        <div class="col l2 center">
                            <h6> <b>VS</b> </h6>
                        </div>
                        <div class="col l5 center">
                            <select name="Loser">
                                {%for i in tour.teams|split:1 %}
                                <option value="{{i}}">{{i}}</option>
                                {%endfor%}
                            </select>
                        </div>
                    </div>
                    <label for="Date">Date</label>
                    <input type="date" name="Date" style="text-align: start;" value="" required>
                    <label for="Time">Time</label>
                    <input type="time" name="Time" value="" placeholder="Time" required>
                    <input type="hidden" name="fromcreate" value="yes">

                </div>
                <div class="modal-footer">
                    <a class="modal-action modal-close -effect -blue btn-flat">Close</a>
                    <input id='btn' type="submit" value="Submit" class="modal-action effect  btn-flat">
                </div>
            </form>
        </div>
        <div id="displayUID" class="modal">
            <div class="modal-content" style="width:100%;">
                <center>
                    <h5 id="uidisphead">
                    </h5>
                    <h4><b> <span id="uidisp">
            </span></b></h4>
                </center>
            </div>
            <div class="modal-footer">
                <input type="submit" onclick="window.location.reload(true);" value="Close" class="modal-close waves-effect waves-blue btn-flat">
                <input type="submit" onclick="CopyToClipboard('uidisp');return false;" value="Copy" class="modal-close waves-effect waves-blue btn-flat">
            </div>
        </div>
        {%for i in tmatches%}
        <div id="code_{{i.id}}" class="modal">
            <div class="modal-content" style="width:100%;">
                <center>
                    <h5>Match code for {{i.type}}: {{i.winner.0}} v {{i.loser.0}} of {{i.tournament}}
                    </h5>
                    <h4><b> <span id="matchcode">
              {{i.uniqueid}}
            </span></b></h4>
                </center>
            </div>
            <div class="modal-footer">
                <input type="submit" value="Close" class="modal-close waves-effect waves-blue btn-flat">
                <input type="submit" value="Copy" onclick="CopyToClipboard('matchcode');return false;" class="modal-close waves-effect waves-blue btn-flat">
            </div>
        </div>
        <div id="edit_{{i.id}}" class="modal">
            <form method="post" action="{% url 'creatematch'%}">
                <div class="modal-content" style="width:100%;">
                    <center>
                        <h4>Match</h4>
                    </center>

                    <input type="hidden" name="status" value="{{i.status}}">
                    <input type="hidden" name="mid" value="{{i.id}}">
                    <input type="text" name="Venue" value="{{i.venue}}" placeholder="Venue" required>
                    <input type="text" name="Type" value="{{i.type}}" placeholder="Type" required>
                    <input type="hidden" name="id" value={{tour.id}} required>
                    <input type="hidden" name="fromcreate" value="yes">
                    <div class="row center">
                        <div class="col l5 center">
                            <select name="Winner" value="{{i.winner.0}}">
                                <option hidden value="{{i.winner.0}}" selected>{{i.winner.0}}</option>
                              </select>
                        </div>
                        <div class="col l2 center">
                            <h5>VS</h5>
                        </div>
                        <div class="col l5 center">
                            <select name="Loser">
                <option  value="{{i.loser.0}}" selected>{{i.loser.0}}</option>
              </select>
                        </div>
                    </div>
                    <label for="Date">Date</label>
                    <input type="date" name="Date" style="text-align: start;" value="{{i.date}}" required>
                    <label for="Time">Time</label>
                    <input type="time" name="Time" value="{{i.time}}" required>
                </div>
                <div class="modal-footer">
                    <a class="modal-action modal-close effect  btn-flat">Close</a>
                    <input type="submit" value="Submit" class="modal-action effect  btn-flat">
                </div>
            </form>
            </form>
        </div>
        <div style="width: 30%;" id="file" class="modal">
            <div class="center">
                <h4>File Import</h4>
            </div>
            <h style="color: black; margin-left: 20px;"><i style="font-size: 20px;color: red;" class="material-icons">cancel</i>Duplicate matches will be deleted automatically!</h>
            <div class="center">
                <form action="{% url 'csv' %}" method="post" enctype="multipart/form-data">

                    <div class="modal-content" style="width: 100%;">
                        <div class="row">
                            <div class="file-field input-field">
                                <div class="center">
                                    <div class="btn">
                                        {% csrf_token %} {{form}}
                                        <span>Upload File</span>
                                    </div>
                                </div>
                                <div class="row"></div>
                                <div class="file-path-wrapper">
                                    <input class="file-path validate" type="text">
                                </div>
                                <input type='hidden' value='{{tid}}' name='t'>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a class="modal-close waves-effect waves-green btn-flat">Close</a>

                        <button style="float: right;" class="modal-action waves-effect waves-blue btn-flat" href="csv" type="submit">submit</button>

                    </div>

                </form>
            </div>
        </div>
        <div id="delete_{{i.id}}" class="modal">
            <form method="post" action="{%url 'deletematch'%}">
                <div class="modal-content" style="width: 100%;">
                    <h4>Confirmation</h4>
                    <p>Delete {{i.type}}: {{i.winner.0}} v {{i.loser.0}} from {{tour.name}}?</p>
                    <input type="hidden" name="id" value="{{i.id}}">
                    <input type="hidden" name="tid" value="{{tour.id}}">
                </div>
                <div class="modal-footer">
                    <a class="modal-close waves-effect waves-green btn-flat">Close</a>
                    <input type="submit" value="Yes" class="modal-action waves-effect waves-blue btn-flat">
                </div>
            </form>
        </div>
        {%endfor%} {% include "components/navbar.html" %}
    </header>
    <main id="body">
        <div class="row">
            <div class="page-container">
                {% include "components/leftpane.html"%}
                <div class="center">
                    <div class="row" style="width:100%;">
                        <div class="top-pane">
                            <div class="row">
                                <div style="height: 85px;" class="live-news-">
                                    <ul class="tabs">
                                        <li id="para" class="tab col s3"><a href="">Match</a></li>
                                        <li id="par" class="tab col s3"><a>Teams</a></li>
                                        <li id="para3" class="tab col s3"><a>Points Table</a></li>
                                    </ul>
                                </div>
                                <div class="col l9">
                                    <h5>{{tour|title}} Matches</h5>
                                    Place : {{tour.place|title}}<br> Teams : {{tour.teams|find_replace:",| "|title }} <br> Year : {{tour.year|capfirst}} {% if messages %}
                                    <ul style="color:red" class="messages">
                                        {% for message in messages %}
                                        <li {% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                    </br>
                                    </br>

                                </div>
                                <div style="margin-right: 0px;" class="col l3">
                                    <a style="border-radius: 16px;margin-top: 20px;float: right;" class="waves-effect waves-light btn blue modal-trigger" href="#create">
                                        <i class="material-icons left">add</i>Create
                                    </a>
                                    <a style="border-radius: 16px;margin-top: 20px;float: right;" class="waves-effect waves-light btn blue modal-trigger" href="#file">
                                        <i class="material-icons left">book</i>Import
                                    </a>

                                </div>

                            </div>


                        </div>
                        <script>
                            document.getElementById("para").onclick = function() {
                                location.href = "/{{tour.id}}/matches";
                            };
                            document.getElementById("par").onclick = function() {
                                location.href = "/{{tour.id}}/teams";
                            };
                            document.getElementById("para3").onclick = function() {
                                location.href = "/{{tour.id}}/pointstable";
                            };
                        </script>


                        <div class="center-pane">

                            <div class="row">
                                <div class="match-tabs">
                                    <table id='myTable' class="bordered striped">
                                        <thead>
                                            <tr>
                                                <th style="text-align: center;">No.</th>
                                                <th style="text-align: center;">Name</th>
                                                <th style="text-align: center;">Venue</th>
                                                <th style="text-align: center;">Date</th>
                                                <th style="text-align: center;">Status</th>
                                                <th style="text-align: center;">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for i in tmatches %}
                                            <tr>
                                                <td style="text-align: center;">{{i.id}}</td>
                                                <td style="text-align: center;">{{i.winner.0}} vs {{i.loser.0}}</td>
                                                <td style="text-align: center;">{{i.venue}}</td>
                                                <td style="text-align: center;">{{i.date}}</td>
                                                <td style="text-align: center;">{{i.status}}</td>
                                                {% if i.status == 'Result' %}
                                                <td style="text-align: center;">
                                                    <a href="{% url 'scorecard' i.id %}">Scorecard</a>
                                                </td>{%elif i.status == 'Live' %}
                                                <td style="text-align: center;">
                                                    <a href="{% url 'scorecard' i.id %}">Live</a>
                                                </td>{%else%}
                                                <td style="text-align: center;"><a class="waves-effect waves-light modal-trigger" href="#edit_{{i.id}}">Edit</a><a>       |</a> <a class="waves-effect waves-light modal-trigger" href="#delete_{{i.id}}">Delete</a><a>       |</a> <a class="waves-effect waves-light modal-trigger"
                                                        href="#code_{{i.id}}">Code</a></td>
                                                {%endif%}
                                            </tr>
                                            {%endfor%}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% include "components/rightpane.html" with rightpane=rightpane %}

            </div>
        </div>
    </main>
    {% include "components/footer.html" %} {% include "components/scripts.html" %}
</body>

</html>